{% extends 'base.html' %}

{% block title %}{% if article %}Editar{% else %}Criar{% endif %} Artigo{% endblock %}

{% block content %}
<div class="bg-white rounded-lg shadow-lg p-8">
    <h2 class="text-2xl font-bold mb-6">{% if article %}Editar{% else %}Criar{% endif %} Artigo</h2>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="mb-4">
            <label class="block text-gray-700 mb-2">Título</label>
            <input type="text" name="title" value="{% if article %}{{ article.title }}{% endif %}" class="w-full border rounded p-2" required>
        </div>
        <div class="mb-4">
            <label class="block text-gray-700 mb-2">Resumo</label>
            <textarea name="excerpt" rows="2" class="w-full border rounded p-2">{% if article %}{{ article.excerpt }}{% endif %}</textarea>
        </div>
        <div class="mb-4">
            <label class="block text-gray-700 mb-2">Conteúdo</label>
            <textarea name="content" rows="10" class="w-full border rounded p-2" required>{% if article %}{{ article.content }}{% endif %}</textarea>
        </div>
        <div class="mb-4">
            <label class="block text-gray-700 mb-2">Imagem</label>
            <input type="file" name="image" class="w-full border rounded p-2">
        </div>
        <div class="mb-4">
            <label class="block text-gray-700 mb-2">Tags (separadas por vírgula)</label>
            <input type="text" name="tags" value="{% if article %}{% for tag in article.tags.all %}{{ tag.name }}{% if not forloop.last %}, {% endif %}{% endfor %}{% endif %}" class="w-full border rounded p-2">
        </div>
        <div class="grid grid-cols-2 gap-4 mb-4">
            <div>
                <label class="block text-gray-700 mb-2">Latitude</label>
                <input type="text" name="latitude" value="{% if article %}{{ article.latitude }}{% endif %}" class="w-full border rounded p-2">
            </div>
            <div>
                <label class="block text-gray-700 mb-2">Longitude</label>
                <input type="text" name="longitude" value="{% if article %}{{ article.longitude }}{% endif %}" class="w-full border rounded p-2">
            </div>
        </div>
        <div class="mb-4">
            <label class="block text-gray-700 mb-2">Nome do Local</label>
            <input type="text" name="location_name" value="{% if article %}{{ article.location_name }}{% endif %}" class="w-full border rounded p-2">
        </div>
        <div class="mb-4">
            <label class="flex items-center">
                <input type="checkbox" name="published" {% if article.published %}checked{% endif %} class="mr-2">
                <span>Publicar artigo</span>
            </label>
        </div>
        {% if user.profile.role == 'admin' %}
            <div class="mb-4">
                <label class="flex items-center">
                    <input type="checkbox" name="featured" {% if article.featured %}checked{% endif %} class="mr-2">
                    <span>Destaque na página inicial</span>
                </label>
            </div>
        {% endif %}
        <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">Salvar</button>
        <a href="{% if article %}{% url 'article_detail' article.slug %}{% else %}{% url 'home' %}{% endif %}" class="ml-2 bg-gray-300 px-6 py-2 rounded hover:bg-gray-400">Cancelar</a>
    </form>
</div>
{% endblock %}
